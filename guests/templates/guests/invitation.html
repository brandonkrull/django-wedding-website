{% extends 'base.html' %}
{% load staticfiles %}
{% block page_head %}
    <link href="{% static 'bigday/css/invitation.css' %}" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Julius+Sans+One' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Tangerine' rel='stylesheet'>
{% endblock %}
{% block page_content %}
    <div class="container">
        <section class="col-sm-8 col-sm-offset-2 text-center" style="background-color: rgba(255,255,255,0.5); padding-bottom: 15px;">
            <div id="invitation-details" style="font-family: 'Julius Sans One', sans-serif; font-size: 20px; padding-top: 50px;">
	    <h4>Together with their families</h4> 
            <h2 style="font-family: tangerine; font-size: 60px;">Alysa Fukunaga</h2> 
	    and 
            <h2 style="font-family: tangerine; font-size: 60px;">Brandon Krull</h2> 
            <p class="lead text-center" style="width: 75%; margin: auto;">
		Invite you to celebrate their marriage<br><br>
		Friday March 30th, 2018<br>
                <!--Friday the Thirtieth of March <br>
		Two Thousand and Eighteen<br>
		at half past four o'clock in the evening<br>-->
		promptly at four thirty in the afternoon<br>
                <h3 style="font-weight: bolder;">The Colony House</h3>
		401 N Anaheim Blvd<br>
                Anaheim, California<br><br>
		Dinner and Dancing to follow
            </p>
            </div>
	    <button id="rsvp" class="h2" style='padding: 15px; border: 0; border-radius: 4px;'>RSVP</button>
            <form data-toggle="validator" id="rsvp-details" class="form-horizontal" method="post" style="display: none;">
                <div class="clearfix"></div>
                {% csrf_token %}
                {% for guest in party.ordered_guests.all %}
                <div class="form-group" data-is-child="{{ guest.is_child }}">
                    {% with 'attending-'|add:guest.unique_id as attending_label %}
                    <div class="row">
                    <label class="h3" for="{{ attending_label }}" class="col-sm-6 col-sm-offset-3">{{ guest.name }}</label>
                    </div>

                    <div class="row">
                    <label class="radio-inline">
                        <input class="attending-radio" type="radio" name="{{ attending_label }}" value="yes" {% if guest.is_attending %}checked="checked"{% endif %} required> will attend
                    </label>
                    <label class="radio-inline">
                        <input class="attending-radio" type="radio" name="{{ attending_label }}" value="no" {% if guest.is_attending == False %}checked="checked"{% endif %} required> will not attend
                    </label>
                    </div>
                    {% endwith %}
                </div>
                {% endfor %}
                <div class="form-group">
                    <input type="text" name="comments" class="form-control" style="width: 80%; margin: 0 auto;"placeholder="Please let us know of any dietary restrictions, or other questions or comments" >
                </div>
                <div class="form-group">
                    <div class="text-center">
                        <input type="submit" class="btn btn-default" value="Submit Response" />
                    </div>
                </div>
            </form>
        </section>
    </div>
{% endblock %}
{% block page_js %}
    <script src="{% static 'validator.js' %}"></script>
    <script>
    $("#rsvp").click(function(){
        $("#rsvp-details").toggle("slow");
    });
    $(function () {
        // enable/disable meal choices based on attendance
        $("input.attending-radio").change(function (e) {
            var target = $(e.target);
            if (target.closest('.form-group').data('is-child') === "True") {
                // don't attempt to update meals for children, who don't have them.
                return;
            }
            var value = target.attr('value');
            var mealButtonContainer = target.closest('.form-group').next('.form-group');
            var mealButtons = mealButtonContainer.find('[type=radio]');
            if (value === 'yes') {
                mealButtonContainer.removeClass('text-muted');
                mealButtons.each(function (index, button) {
                    button.disabled = false;
                    button.required = true;
                });
            } else if (value === "no") {
                mealButtonContainer.addClass('text-muted');
                mealButtons.each(function (index, button) {
                    button.checked = false;
                    button.disabled = true;
                    button.required = false;
                });
            }
            // reload validation
            $(document.forms[0]).validator('destroy');
            $(document.forms[0]).validator();
        });
    });
    </script>
{% endblock %}
